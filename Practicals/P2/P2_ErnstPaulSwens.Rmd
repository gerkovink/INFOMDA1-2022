---
title: "Practical 2 Data visualization" 
subtitle: "Supervised Learning & Visualization"
author: "Ernst Paul Swens"
date: "`r format(Sys.time(), '%B, %Y')`"
output: 
   html_document:
      toc: true
      number_sections: false
      toc_float:
         collapsed: true
         smooth_scroll: true
---

```{r message=FALSE, warning=FALSE, include=FALSE}
library(ISLR)
library(tidyverse)
```

# Q1

**Name the aesthetics, geoms, scales, and facets of the above visualisation. Also name any statistical transformations or special coordinate systems.** 

```{r}
# aesthetics: x = number of hits, y = number of homeruns
# geoms: scatterplot, 2d density plot 
# scales: x = continuous, y = continuous 
# facets: none
# statistical transformation: none
# special coordinate systems: none
```


# Q2

**Run the code below to generate data. There will be three vectors in your environment. Put them in a data frame for entering it in a `ggplot()` call using either the `data.frame()` or the `tibble()` function. Give informative names and make sure the types are correct (use the `as.<type>()` functions). Name the result `gg_students`.** 

```{r}
set.seed(1234)
student_grade  <- rnorm(32, 7)
student_number <- round(runif(32) * 2e6 + 5e6)
programme      <- sample(c("Science", "Social Science"), 32, replace = TRUE)

gg_students <- data.frame(student_grade, student_number, programme)
lapply(gg_students, class)
```


# Q3

**Plot the first `homeruns_plot` again, but map the `Hits` to the y-axis and the `HmRun` to the x-axis instead.** 

```{r}
ggplot(Hitters, aes(x = HmRun, y = Hits)) + 
  geom_point()
```


# Q4

**Recreate the same plot once more, but now also map the variable `League` to the colour aesthetic and the variable `Salary` to the size aesthetic.** 

```{r}
ggplot(Hitters, aes(x = HmRun, y = Hits, color = League, size = Salary)) + 
  geom_point()
```

# Q5

**Look at the many different geoms on the reference website.** 

```{r}
# Okay
```


# Q6

**Use `geom_histogram()` to create a histogram of the grades of the students in the gg_students dataset. Play around with the binwidth argument of the `geom_histogram()` function.**

```{r}
ggplot(gg_students, aes(x = student_grade)) + 
  geom_histogram(binwidth = 1)
```


# Q7

**Use `geom_density()` to create a density plot of the grades of the students in the gg_students dataset. Add the argument `fill = "light seagreen"` to `geom_density()`.**

```{r}
ggplot(gg_students, aes(x = student_grade)) + 
   geom_density(fill = "light seagreen")
```


# Q8 

**Add rug marks to the density plot through `geom_rug()`. You can edit the colour and size of the rug marks using those arguments within the `geom_rug()` function.**

```{r}
ggplot(gg_students, aes(x = student_grade)) + 
   geom_density(fill = "light seagreen") + 
   geom_rug(colour = "light seagreen", size = 1)
```

# Q9

**Increase the data to ink ratio by removing the y axis label, setting the theme to `theme_minimal()`, and removing the border of the density polygon. Also set the limits of the x-axis to go from 0 to 10 using the `xlim()` function, because those are the plausible values for a student grade.**

```{r}
ggplot(gg_students, aes(x = student_grade)) + 
   geom_density(fill = "light seagreen", color = NA) + 
   geom_rug(colour = "light seagreen", size = 1) +
   theme_minimal() + 
   xlim(0,10)
```

# Q10

**Create a boxplot of student grades per programme in the `gg_students` dataset you made earlier: map the programme variable to the x position and the grade to the y position. For extra visual aid, you can additionally map the programme variable to the fill aesthetic.**

```{r}
ggplot(gg_students, aes(x = programme, y = student_grade, fill = programme)) + 
  geom_boxplot()
```

# Q11

**What do each of the horizontal lines in the boxplot mean? What do the vertical lines (whiskers) mean?**

```{r}
# The bold middle line is the median. 
# The other lines are the 25th and 75th percentile. 
# The upper vertical line represent 1.5 * inter quartile range. 
# The lower vertical line represent -1.5 * inter quartile range. 
```


# Q12

**Comparison of distributions across categories can also be done by adding a fill aesthetic to the density plot you made earlier. Try this out. To take care of the overlap, you might want to add some transparency in the `geom_density()` function using the `alpha` argument**

```{r}
ggplot(gg_students, aes(x = student_grade)) + 
   geom_density(aes(fill = programme), color = NA, alpha = 0.3) + 
   geom_rug(aes(colour = programme), size = 1) +
   theme_minimal() + 
   xlim(0,10)
```


# Q13

**Create a bar plot of the variable `Years` from the `Hitters` dataset.**

```{r}
ggplot(Hitters, aes(x = Years)) + 
   geom_bar()
```

# Q14

**Use `geom_line()` to make a line plot out of the first 200 observations of the variable Volume (the number of trades made on each day) of the `Smarket` dataset. You will need to create a Day variable using `mutate()` to map to the x-position. This variable can simply be the integers from 1 to 200. Remember, you can select the first 200 rows using `Smarket[1:200, ]`.**

```{r}
Smarket %>% 
   mutate(Day = row_number()) %>% 
   filter(Day < 201) %>% 
   ggplot(aes(x = Day, y = Volume)) +
   geom_line()
```

# Q15

**Give the line a nice colour and increase its size. Also add points of the same colour on top.**

```{r}
Smarket %>% 
   mutate(Day = row_number()) %>% 
   filter(Day < 201) %>% 
   ggplot(aes(x = Day, y = Volume)) +
   geom_line(size = 1, color = "red")
```

# Q16

**Use the function `which.max()` to find out which of the first 200 days has the highest trade volume and use the function `max()` to find out how large this volume was.**

```{r message=FALSE, warning=FALSE}
Smarket %>% 
   mutate(Day = row_number()) %>% 
   filter(Day < 201) %>% 
   summarise(day = which.max(Volume), volume = max(Volume))
```

# Q17

**Use `geom_label(aes(x = your_x, y = your_y, label = "Peak volume"))` to add a label to this day. You can use either the values or call the functions. Place the label near the peak!**

```{r}
Smarket %>% 
   mutate(Day = row_number()) %>% 
   filter(Day < 201) %>% 
   ggplot(aes(x = Day, y = Volume)) +
   geom_line(size = 1, color = "red") + 
   geom_label(aes(x = 170, y = 2.33083	, label = "Peak volume"))
```

# Q18

**Create a data frame called baseball based on the `Hitters` dataset. In this data frame, create a factor variable which splits playersâ€™ salary range into 3 categories. Tip: use the `filter()` function to remove the missing values, and then use the `cut()` function and assign nice labels to the categories. In addition, create a variable which indicates the proportion of career hits that was a home run.**

```{r}
Hitters %>% 
  filter(!is.na(Salary)) %>% 
  mutate(Salary_category = cut(Salary, breaks = c(0, 200, 1000, 9000), 
                               labels = c("low", "medium", "high")),
         Percentage_hm = HmRun/Hits)
```

# Q19

**Create a scatter plot where you map `CWalks` to the x position and the proportion you calculated in the previous exercise to the y position. Fix the y axis limits to (0, 0.4) and the x axis to (0, 1600) using `ylim()` and `xlim()`. Add nice x and y axis titles using the `labs()` function. Save the plot as the variable `baseball_plot`.**

```{r}
baseball_plot <- Hitters %>% 
  filter(!is.na(Salary)) %>% 
  mutate(Salary_category = cut(Salary, breaks = c(0, 200, 1000, 9000), 
                               labels = c("low", "medium", "high")),
         Percentage_hm = HmRun/Hits) %>%
  ggplot(aes(x = CWalks, y = Percentage_hm)) +
  geom_point() + 
  ylim(0, 0.4) + 
  xlim(0, 1600) + 
  labs(x = "Cwalks", y = "Percentage Home Runs")

baseball_plot
```

# Q20

**Split up this plot into three parts based on the salary range variable you calculated. Use the `facet_wrap()` function for this; look at the examples in the help file for tips.**

```{r}
baseball_plot + facet_wrap(~Salary_category)
```

# Q21

**Create an interesting data visualisation based on the `Carseats` data from the ISLR package.**

```{r}
Carseats %>% ggplot(aes(x = CompPrice, y = Price)) + 
   geom_point() + 
   geom_smooth(formula = y ~ x, method = lm, se = FALSE) + 
   facet_wrap(~ShelveLoc)
```











